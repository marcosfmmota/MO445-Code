<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libIFT: /home/vdalla/ift/demo/ImageActiveLearning/include/iftSuperpixelFeatures.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://www.mathjax.org/mathjax/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libIFT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b6c2a257bfab6380ca9b3cb94b12cb25.html">demo</a></li><li class="navelem"><a class="el" href="../../dir_9c8b383c01989677e0a5595aaec09e4f.html">ImageActiveLearning</a></li><li class="navelem"><a class="el" href="../../dir_023e33a891bab09898c378c156dfe33a.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">iftSuperpixelFeatures.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>July 6, 2017</dd></dl>
<p>General utility to extract features from superpixel segmentations. All methods work for both 2D and 3D unless explicitly noticed. To avoid using the non-standard terminology 'supervoxel', we only refer to 'superpixels' and 'pixels' even in methods that work in 3D.</p>
<p>We assume superpixel segmentations are represented by a <code><a class="el" href="../../d5/dec/structiftImage.html" title="iftImage definition and prototypes. ">iftImage</a></code> containing the superpixel label map.</p>
<p>For now results are always stored into an <code>iftMatrix</code> where the row r corresponds to the superpixel of label r. </p>
</div><div class="textblock"><code>#include &lt;ift.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d00/iftHISF_8h.html">iftHISF.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d2e/iftBoVW_8h.html">iftBoVW.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aabfcbc8d3ad500cc3aeb6cbb72a9b2b6"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#aabfcbc8d3ad500cc3aeb6cbb72a9b2b6">iftCovarianceDistance</a> (float *f1, float *f2, float *alpha, int n)</td></tr>
<tr class="memdesc:aabfcbc8d3ad500cc3aeb6cbb72a9b2b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distance function for covariance matrices.  <a href="#aabfcbc8d3ad500cc3aeb6cbb72a9b2b6">More...</a><br /></td></tr>
<tr class="separator:aabfcbc8d3ad500cc3aeb6cbb72a9b2b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59cf5653577047928104f25014fe758f"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a59cf5653577047928104f25014fe758f">iftComputeSuperpixelFeaturesByGeometricCenter</a> (const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *superpixelLabelMap)</td></tr>
<tr class="memdesc:a59cf5653577047928104f25014fe758f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use geometric center as superpixel feature.  <a href="#a59cf5653577047928104f25014fe758f">More...</a><br /></td></tr>
<tr class="separator:a59cf5653577047928104f25014fe758f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a934a14d63051913cad5773b697f14830"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a934a14d63051913cad5773b697f14830">iftComputeSuperpixelFeaturesByColorSpaceMean</a> (const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *superpixelLabelMap, const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *img, <a class="el" href="../../d4/dd4/iftColor_8h.html#ae77a35b2556cfdb022dff7acaddc4985">iftColorSpace</a> colorSpace)</td></tr>
<tr class="memdesc:a934a14d63051913cad5773b697f14830"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use mean of some color space as superpixel feature.  <a href="#a934a14d63051913cad5773b697f14830">More...</a><br /></td></tr>
<tr class="separator:a934a14d63051913cad5773b697f14830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24a058d1a1a72f416288b63f65cb8b29"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a24a058d1a1a72f416288b63f65cb8b29">iftComputeSuperpixelFeaturesByMImageMean</a> (const <a class="el" href="../../d4/d89/structiftMImage.html">iftMImage</a> *mimg, const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *superpixelLabelMap)</td></tr>
<tr class="memdesc:a24a058d1a1a72f416288b63f65cb8b29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use mean of mimage values as superpixel feature.  <a href="#a24a058d1a1a72f416288b63f65cb8b29">More...</a><br /></td></tr>
<tr class="separator:a24a058d1a1a72f416288b63f65cb8b29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5315fb6119db8b31bde29e6fac94547"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#ab5315fb6119db8b31bde29e6fac94547">iftComputeSuperpixelFeaturesByColorSpaceMedoid</a> (const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *superpixelLabelMap, const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *img, <a class="el" href="../../d4/dd4/iftColor_8h.html#ae77a35b2556cfdb022dff7acaddc4985">iftColorSpace</a> colorSpace)</td></tr>
<tr class="memdesc:ab5315fb6119db8b31bde29e6fac94547"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use medoid of some color space as superpixel feature.  <a href="#ab5315fb6119db8b31bde29e6fac94547">More...</a><br /></td></tr>
<tr class="separator:ab5315fb6119db8b31bde29e6fac94547"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ade3bcc6fe70628fa47887337471833"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a6ade3bcc6fe70628fa47887337471833">iftComputeSuperpixelFeaturesByMImageMedoid</a> (const <a class="el" href="../../d4/d89/structiftMImage.html">iftMImage</a> *mimg, const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *superpixelLabelMap)</td></tr>
<tr class="memdesc:a6ade3bcc6fe70628fa47887337471833"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use medoid of pixel values as superpixel feature.  <a href="#a6ade3bcc6fe70628fa47887337471833">More...</a><br /></td></tr>
<tr class="separator:a6ade3bcc6fe70628fa47887337471833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1303d4988091121e238947cc49dff19b"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a1303d4988091121e238947cc49dff19b">iftComputeSuperpixelFeaturesByColorBoVW</a> (const <a class="el" href="../../d4/d89/structiftMImage.html">iftMImage</a> *mimg, const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *superpixelLabelMap, const <a class="el" href="../../db/d81/structiftBoVW.html">iftBoVW</a> *bag, int k)</td></tr>
<tr class="memdesc:a1303d4988091121e238947cc49dff19b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use the BoVW histogram as superpixel feature.  <a href="#a1303d4988091121e238947cc49dff19b">More...</a><br /></td></tr>
<tr class="separator:a1303d4988091121e238947cc49dff19b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50a03c05981708fab9dfdf71fdbde4e7"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a50a03c05981708fab9dfdf71fdbde4e7">iftComputeSuperpixelFeaturesByRegionCovarianceMatrix</a> (const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *superpixelLabelMap, const iftMatrix *pixelFeats)</td></tr>
<tr class="memdesc:a50a03c05981708fab9dfdf71fdbde4e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use superpixel covariance matrix as feature.  <a href="#a50a03c05981708fab9dfdf71fdbde4e7">More...</a><br /></td></tr>
<tr class="separator:a50a03c05981708fab9dfdf71fdbde4e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3956122192ce3cfb8af150c93e8cf270"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a3956122192ce3cfb8af150c93e8cf270">iftComputeSuperpixelFeaturesByColorHistogram</a> (const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *img, const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *labelMap, int binsPerColor)</td></tr>
<tr class="memdesc:a3956122192ce3cfb8af150c93e8cf270"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes color histogram for superpixels.  <a href="#a3956122192ce3cfb8af150c93e8cf270">More...</a><br /></td></tr>
<tr class="separator:a3956122192ce3cfb8af150c93e8cf270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fda8cc0fec548ed7024c96f4ba39fed"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a2fda8cc0fec548ed7024c96f4ba39fed">iftComputeSuperpixelFeaturesByBICHistogram</a> (const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *img, const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *labelMap, int binsPerColor)</td></tr>
<tr class="memdesc:a2fda8cc0fec548ed7024c96f4ba39fed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes BIC histogram for superpixels.  <a href="#a2fda8cc0fec548ed7024c96f4ba39fed">More...</a><br /></td></tr>
<tr class="separator:a2fda8cc0fec548ed7024c96f4ba39fed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46cb8c16901601540794c7de4a352e1b"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a46cb8c16901601540794c7de4a352e1b">iftComputeSuperpixelFeaturesByNeighborHistogram</a> (const <a class="el" href="../../d6/db9/structiftSuperpixelIGraph.html">iftSuperpixelIGraph</a> *igraph, iftMatrix *spHistFeats, int neighDist)</td></tr>
<tr class="memdesc:a46cb8c16901601540794c7de4a352e1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes contextual histogram for superpixels.  <a href="#a46cb8c16901601540794c7de4a352e1b">More...</a><br /></td></tr>
<tr class="separator:a46cb8c16901601540794c7de4a352e1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a479907d9fdb582da74c8c001c1a11415"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a479907d9fdb582da74c8c001c1a11415">iftComputeSuperpixelFeaturesByContextualColorHistogram</a> (const <a class="el" href="../../d6/db9/structiftSuperpixelIGraph.html">iftSuperpixelIGraph</a> *igraph, const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *img, int binsPerColor, int order)</td></tr>
<tr class="memdesc:a479907d9fdb582da74c8c001c1a11415"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes color histogram at multiple superpixel distances.  <a href="#a479907d9fdb582da74c8c001c1a11415">More...</a><br /></td></tr>
<tr class="separator:a479907d9fdb582da74c8c001c1a11415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6731d3551edf7489de575d0064700d09"><td class="memItemLeft" align="right" valign="top">iftMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a6731d3551edf7489de575d0064700d09">iftComputeSuperpixelFeaturesByContextualBICHistogram</a> (const <a class="el" href="../../d6/db9/structiftSuperpixelIGraph.html">iftSuperpixelIGraph</a> *igraph, const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *img, int binsPerColor, int order)</td></tr>
<tr class="memdesc:a6731d3551edf7489de575d0064700d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes BIC histogram at multiple superpixel distances.  <a href="#a6731d3551edf7489de575d0064700d09">More...</a><br /></td></tr>
<tr class="separator:a6731d3551edf7489de575d0064700d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2fda8cc0fec548ed7024c96f4ba39fed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fda8cc0fec548ed7024c96f4ba39fed">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByBICHistogram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByBICHistogram </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>labelMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>binsPerColor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes BIC histogram for superpixels. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January 5, 2017</dd></dl>
<p>There is a very similar function that creates a <a class="el" href="../../dd/d29/structiftDataSet.html" title="Dataset structure for pattern recognition. ">iftDataSet</a> of superpixel BIC histogram features. This one exists more as a supplement for the superpixel contextual features. </p>
<div class="fragment"><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;{</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordtype">int</span> nSuperpixels = <a class="code" href="../../da/d89/iftImage_8h.html#a3ff31caa90348c2bc163738acda2fad3">iftMaximumValue</a>(labelMap);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordtype">int</span> nDims = <a class="code" href="../../da/d89/iftImage_8h.html#a017d1b437805fe67ddc00c7aff48e5da">iftIsColorImage</a>(img) ? 3 : 1;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordtype">int</span> nBins = lround(pow(binsPerColor, nDims));</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  iftMatrix *feats = iftCreateMatrix(nBins * 2, nSuperpixels);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <a class="code" href="../../d5/dec/structiftImage.html">iftImage</a> *binImage = iftColorHistogramAssignPixelBin(img, binsPerColor);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <a class="code" href="../../d5/dec/structiftImage.html">iftImage</a> *mask = iftBICMask(binImage);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; labelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a7aeea55b5b8596a61e1260829124b0e8">n</a>; ++p) {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">int</span> offset = (mask-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[p] &gt; 0 ? nBins : 0);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">int</span> label = labelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[p] - 1;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    iftMatrixRowPointer(feats, label)[binImage-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[p] + offset] += 1.0;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="../../da/d89/iftImage_8h.html#a00dc5e984634e16895da5139a7c3dc1e">iftDestroyImage</a>(&amp;binImage);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="../../da/d89/iftImage_8h.html#a00dc5e984634e16895da5139a7c3dc1e">iftDestroyImage</a>(&amp;mask);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">return</span> feats;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="ttc" id="iftImage_8h_html_a017d1b437805fe67ddc00c7aff48e5da"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#a017d1b437805fe67ddc00c7aff48e5da">iftIsColorImage</a></div><div class="ttdeci">static bool iftIsColorImage(const iftImage *img)</div><div class="ttdoc">Check if the image has color information. </div><div class="ttdef"><b>Definition:</b> iftImage.h:317</div></div>
<div class="ttc" id="iftImage_8h_html_a00dc5e984634e16895da5139a7c3dc1e"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#a00dc5e984634e16895da5139a7c3dc1e">iftDestroyImage</a></div><div class="ttdeci">void iftDestroyImage(iftImage **img)</div><div class="ttdoc">Destroys the image. </div></div>
<div class="ttc" id="structiftImage_html_acd0db223f77f5e403a1431ebc2636bf1"><div class="ttname"><a href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">iftImage::val</a></div><div class="ttdeci">int * val</div><div class="ttdef"><b>Definition:</b> iftImage.h:115</div></div>
<div class="ttc" id="iftImage_8h_html_a3ff31caa90348c2bc163738acda2fad3"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#a3ff31caa90348c2bc163738acda2fad3">iftMaximumValue</a></div><div class="ttdeci">int iftMaximumValue(const iftImage *img)</div><div class="ttdoc">swig() </div></div>
<div class="ttc" id="structiftImage_html_a7aeea55b5b8596a61e1260829124b0e8"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a7aeea55b5b8596a61e1260829124b0e8">iftImage::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> iftImage.h:140</div></div>
<div class="ttc" id="structiftImage_html"><div class="ttname"><a href="../../d5/dec/structiftImage.html">iftImage</a></div><div class="ttdoc">iftImage definition and prototypes. </div><div class="ttdef"><b>Definition:</b> iftImage.h:113</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1303d4988091121e238947cc49dff19b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1303d4988091121e238947cc49dff19b">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByColorBoVW()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByColorBoVW </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/d89/structiftMImage.html">iftMImage</a> *&#160;</td>
          <td class="paramname"><em>mimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>superpixelLabelMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d81/structiftBoVW.html">iftBoVW</a> *&#160;</td>
          <td class="paramname"><em>bag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use the BoVW histogram as superpixel feature. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 28, 2017</dd></dl>
<p>For each superpixel, build a normalized BoVW histogram where each input is the feature vector of one pixel. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../db/d81/structiftBoVW.html" title="BoVW descriptor. ">iftBoVW</a></dd></dl>
<p>The returned <code>iftMatrix</code> is owned by the caller. </p><dl class="section see"><dt>See also</dt><dd>iftDestroyMatrix()</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mimg</td><td>Base MImage. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">superpixelLabelMap</td><td>Some superpixel segmentation of mimg. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bag</td><td>Pointer to the BoVW descriptor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Soft assignment k. k = 1 for hard assignment. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The (nSuperpixels x nBins) feature matrix of normalized histograms.</dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>mimg</code> and <code>superpixelLabelMap</code> are not NULL and share the same spatial domain. </dd>
<dd>
<code>superpixelLabelMap</code> does not contain label gaps. </dd>
<dd>
<code>bag</code> is not NULL and is compatible with mimg feature vector </dd></dl>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;{</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  ssygvd_(NULL, NULL, NULL, NULL, NULL,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      NULL, NULL, NULL, NULL, NULL,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      NULL, NULL, NULL, NULL);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  assert(mimg != NULL &amp;&amp; superpixelLabelMap != NULL);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  assert(mimg-&gt;xsize == superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a0bbd7827516731bf81910e5e46904cb6">xsize</a>);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  assert(mimg-&gt;ysize == superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a940438838adf1ddd80c3057fdae847ef">ysize</a>);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  assert(mimg-&gt;zsize == superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a044215d2c7df412a81fedd913216e719">zsize</a>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// TODO assert(check label map consistency) </span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  assert(mimg-&gt;m == bag-&gt;<a class="code" href="../../db/d81/structiftBoVW.html#ad6c0aa50bb6e55da7b745af2a4871f3c">nFeats</a>);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordtype">int</span> nSuperpixels = <a class="code" href="../../da/d89/iftImage_8h.html#a3ff31caa90348c2bc163738acda2fad3">iftMaximumValue</a>(superpixelLabelMap);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordtype">float</span> *featVector = <a class="code" href="../../de/d85/group__Memory.html#ga241f5543f05614a13e66b9fc5b0f8f27">iftAllocFloatArray</a>(mimg-&gt;m);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  iftMatrix *mx = iftCreateMatrix(bag-&gt;<a class="code" href="../../db/d81/structiftBoVW.html#a552c7e817f749fe8cedb3c69175336d7">nBins</a>, nSuperpixels); </div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// Assign one pixel at a time</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; mimg-&gt;n; ++p) {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">int</span> row = superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[p] - 1;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span> (row &lt; 0)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// Copy mimg pixel feature vector into float array for convenience</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; mimg-&gt;m; ++f)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      featVector[f] = mimg-&gt;band[f].val[p]; </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// Assign pixel feature vector to histogram</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="../../dd/d2e/iftBoVW_8h.html#a2ffbed2cc1f188556e449c4aba904912">iftBoVWSoftAssignment</a>(bag, featVector, iftMatrixRowPointer(mx, row), k);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// Normalize histograms</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; mx-&gt;nrows; ++row) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordtype">float</span> histogramTotal = 0.0;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// Naive float accumulation, O(n) error</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; mx-&gt;ncols; ++col)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      histogramTotal += mx-&gt;val[iftGetMatrixIndex(mx,col,row)];</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; mx-&gt;ncols; ++col)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      mx-&gt;val[iftGetMatrixIndex(mx,col,row)] /= histogramTotal;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  free(featVector);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">return</span> mx;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div><div class="ttc" id="group__Memory_html_ga241f5543f05614a13e66b9fc5b0f8f27"><div class="ttname"><a href="../../de/d85/group__Memory.html#ga241f5543f05614a13e66b9fc5b0f8f27">iftAllocFloatArray</a></div><div class="ttdeci">float * iftAllocFloatArray(long n)</div><div class="ttdoc">Allocates a Char Array (string) with n positions. </div></div>
<div class="ttc" id="structiftImage_html_a940438838adf1ddd80c3057fdae847ef"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a940438838adf1ddd80c3057fdae847ef">iftImage::ysize</a></div><div class="ttdeci">int ysize</div><div class="ttdef"><b>Definition:</b> iftImage.h:126</div></div>
<div class="ttc" id="structiftBoVW_html_a552c7e817f749fe8cedb3c69175336d7"><div class="ttname"><a href="../../db/d81/structiftBoVW.html#a552c7e817f749fe8cedb3c69175336d7">iftBoVW::nBins</a></div><div class="ttdeci">int nBins</div><div class="ttdef"><b>Definition:</b> iftBoVW.h:61</div></div>
<div class="ttc" id="iftBoVW_8h_html_a2ffbed2cc1f188556e449c4aba904912"><div class="ttname"><a href="../../dd/d2e/iftBoVW_8h.html#a2ffbed2cc1f188556e449c4aba904912">iftBoVWSoftAssignment</a></div><div class="ttdeci">void iftBoVWSoftAssignment(const iftBoVW *bag, const float *input, float *histogram, int k)</div><div class="ttdoc">Soft assignment of a feature vector into a BoVW histogram. </div><div class="ttdef"><b>Definition:</b> iftBoVW.c:165</div></div>
<div class="ttc" id="structiftImage_html_a0bbd7827516731bf81910e5e46904cb6"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a0bbd7827516731bf81910e5e46904cb6">iftImage::xsize</a></div><div class="ttdeci">int xsize</div><div class="ttdef"><b>Definition:</b> iftImage.h:124</div></div>
<div class="ttc" id="structiftImage_html_acd0db223f77f5e403a1431ebc2636bf1"><div class="ttname"><a href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">iftImage::val</a></div><div class="ttdeci">int * val</div><div class="ttdef"><b>Definition:</b> iftImage.h:115</div></div>
<div class="ttc" id="iftImage_8h_html_a3ff31caa90348c2bc163738acda2fad3"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#a3ff31caa90348c2bc163738acda2fad3">iftMaximumValue</a></div><div class="ttdeci">int iftMaximumValue(const iftImage *img)</div><div class="ttdoc">swig() </div></div>
<div class="ttc" id="structiftBoVW_html_ad6c0aa50bb6e55da7b745af2a4871f3c"><div class="ttname"><a href="../../db/d81/structiftBoVW.html#ad6c0aa50bb6e55da7b745af2a4871f3c">iftBoVW::nFeats</a></div><div class="ttdeci">int nFeats</div><div class="ttdef"><b>Definition:</b> iftBoVW.h:59</div></div>
<div class="ttc" id="structiftImage_html_a044215d2c7df412a81fedd913216e719"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a044215d2c7df412a81fedd913216e719">iftImage::zsize</a></div><div class="ttdeci">int zsize</div><div class="ttdef"><b>Definition:</b> iftImage.h:128</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3956122192ce3cfb8af150c93e8cf270"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3956122192ce3cfb8af150c93e8cf270">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByColorHistogram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByColorHistogram </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>labelMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>binsPerColor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes color histogram for superpixels. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January 5, 2017</dd></dl>
<p>There is a very similar function that creates a <a class="el" href="../../dd/d29/structiftDataSet.html" title="Dataset structure for pattern recognition. ">iftDataSet</a> of superpixel color histogram features. This one exists more as a supplement for the superpixel contextual features.</p>
<dl class="section return"><dt>Returns</dt><dd>Each row is a superpixel histogram (NOT normalized). </dd></dl>
<div class="fragment"><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;{</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordtype">int</span> nSuperpixels = <a class="code" href="../../da/d89/iftImage_8h.html#a3ff31caa90348c2bc163738acda2fad3">iftMaximumValue</a>(labelMap);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordtype">int</span> nDims = <a class="code" href="../../da/d89/iftImage_8h.html#a017d1b437805fe67ddc00c7aff48e5da">iftIsColorImage</a>(img) ? 3 : 1;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordtype">int</span> nBins = lround(pow(binsPerColor, nDims));</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  iftMatrix *feats = iftCreateMatrix(nBins, nSuperpixels);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <a class="code" href="../../d5/dec/structiftImage.html">iftImage</a> *binImage = iftColorHistogramAssignPixelBin(img, binsPerColor);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; labelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a7aeea55b5b8596a61e1260829124b0e8">n</a>; ++p) {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">int</span> label = labelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[p] - 1;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    iftMatrixRowPointer(feats, label)[binImage-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[p]] += 1.0;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <a class="code" href="../../da/d89/iftImage_8h.html#a00dc5e984634e16895da5139a7c3dc1e">iftDestroyImage</a>(&amp;binImage);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">return</span> feats;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;}</div><div class="ttc" id="iftImage_8h_html_a017d1b437805fe67ddc00c7aff48e5da"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#a017d1b437805fe67ddc00c7aff48e5da">iftIsColorImage</a></div><div class="ttdeci">static bool iftIsColorImage(const iftImage *img)</div><div class="ttdoc">Check if the image has color information. </div><div class="ttdef"><b>Definition:</b> iftImage.h:317</div></div>
<div class="ttc" id="iftImage_8h_html_a00dc5e984634e16895da5139a7c3dc1e"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#a00dc5e984634e16895da5139a7c3dc1e">iftDestroyImage</a></div><div class="ttdeci">void iftDestroyImage(iftImage **img)</div><div class="ttdoc">Destroys the image. </div></div>
<div class="ttc" id="structiftImage_html_acd0db223f77f5e403a1431ebc2636bf1"><div class="ttname"><a href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">iftImage::val</a></div><div class="ttdeci">int * val</div><div class="ttdef"><b>Definition:</b> iftImage.h:115</div></div>
<div class="ttc" id="iftImage_8h_html_a3ff31caa90348c2bc163738acda2fad3"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#a3ff31caa90348c2bc163738acda2fad3">iftMaximumValue</a></div><div class="ttdeci">int iftMaximumValue(const iftImage *img)</div><div class="ttdoc">swig() </div></div>
<div class="ttc" id="structiftImage_html_a7aeea55b5b8596a61e1260829124b0e8"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a7aeea55b5b8596a61e1260829124b0e8">iftImage::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> iftImage.h:140</div></div>
<div class="ttc" id="structiftImage_html"><div class="ttname"><a href="../../d5/dec/structiftImage.html">iftImage</a></div><div class="ttdoc">iftImage definition and prototypes. </div><div class="ttdef"><b>Definition:</b> iftImage.h:113</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a934a14d63051913cad5773b697f14830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a934a14d63051913cad5773b697f14830">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByColorSpaceMean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByColorSpaceMean </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>superpixelLabelMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/dd4/iftColor_8h.html#ae77a35b2556cfdb022dff7acaddc4985">iftColorSpace</a>&#160;</td>
          <td class="paramname"><em>colorSpace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use mean of some color space as superpixel feature. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>August 1, 2017</dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000004">Todo:</a></b></dt><dd>Fill in params and preconditions. </dd></dl>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="code" href="../../d4/d89/structiftMImage.html">iftMImage</a> *mimg = iftImageToMImage(img, colorSpace);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  iftMatrix *res = <a class="code" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a24a058d1a1a72f416288b63f65cb8b29">iftComputeSuperpixelFeaturesByMImageMean</a>(mimg, superpixelLabelMap);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  iftDestroyMImage(&amp;mimg);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div><div class="ttc" id="structiftMImage_html"><div class="ttname"><a href="../../d4/d89/structiftMImage.html">iftMImage</a></div><div class="ttdoc">swig(extend = iftMImageExt.i, destroyer = iftDestroyMImage) </div><div class="ttdef"><b>Definition:</b> iftMImage.h:24</div></div>
<div class="ttc" id="iftSuperpixelFeatures_8h_html_a24a058d1a1a72f416288b63f65cb8b29"><div class="ttname"><a href="../../d0/d68/iftSuperpixelFeatures_8h.html#a24a058d1a1a72f416288b63f65cb8b29">iftComputeSuperpixelFeaturesByMImageMean</a></div><div class="ttdeci">iftMatrix * iftComputeSuperpixelFeaturesByMImageMean(const iftMImage *mimg, const iftImage *superpixelLabelMap)</div><div class="ttdoc">Use mean of mimage values as superpixel feature. </div><div class="ttdef"><b>Definition:</b> iftSuperpixelFeatures.c:227</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5315fb6119db8b31bde29e6fac94547"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5315fb6119db8b31bde29e6fac94547">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByColorSpaceMedoid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByColorSpaceMedoid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>superpixelLabelMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/dd4/iftColor_8h.html#ae77a35b2556cfdb022dff7acaddc4985">iftColorSpace</a>&#160;</td>
          <td class="paramname"><em>colorSpace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use medoid of some color space as superpixel feature. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>August 1, 2017</dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000005">Todo:</a></b></dt><dd>Fill in params and preconditions. </dd></dl>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="code" href="../../d4/d89/structiftMImage.html">iftMImage</a> *mimg = iftImageToMImage(img, colorSpace);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  iftMatrix *res = <a class="code" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a6ade3bcc6fe70628fa47887337471833">iftComputeSuperpixelFeaturesByMImageMedoid</a>(mimg, superpixelLabelMap);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  iftDestroyMImage(&amp;mimg);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div><div class="ttc" id="structiftMImage_html"><div class="ttname"><a href="../../d4/d89/structiftMImage.html">iftMImage</a></div><div class="ttdoc">swig(extend = iftMImageExt.i, destroyer = iftDestroyMImage) </div><div class="ttdef"><b>Definition:</b> iftMImage.h:24</div></div>
<div class="ttc" id="iftSuperpixelFeatures_8h_html_a6ade3bcc6fe70628fa47887337471833"><div class="ttname"><a href="../../d0/d68/iftSuperpixelFeatures_8h.html#a6ade3bcc6fe70628fa47887337471833">iftComputeSuperpixelFeaturesByMImageMedoid</a></div><div class="ttdeci">iftMatrix * iftComputeSuperpixelFeaturesByMImageMedoid(const iftMImage *mimg, const iftImage *superpixelLabelMap)</div><div class="ttdoc">Use medoid of pixel values as superpixel feature. </div><div class="ttdef"><b>Definition:</b> iftSuperpixelFeatures.c:266</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6731d3551edf7489de575d0064700d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6731d3551edf7489de575d0064700d09">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByContextualBICHistogram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByContextualBICHistogram </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/db9/structiftSuperpixelIGraph.html">iftSuperpixelIGraph</a> *&#160;</td>
          <td class="paramname"><em>igraph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>binsPerColor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes BIC histogram at multiple superpixel distances. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January 5, 2017 </dd></dl>
<div class="fragment"><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;{</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  iftMatrix *baseHist = <a class="code" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a2fda8cc0fec548ed7024c96f4ba39fed">iftComputeSuperpixelFeaturesByBICHistogram</a>(img, igraph-&gt;<a class="code" href="../../d6/db9/structiftSuperpixelIGraph.html#a6c2fb5eb399b42009da6255ec3ec0a44">refImg</a>, binsPerColor);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  iftMatrix *res = iftCopyMatrix(baseHist);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  iftNormalizeSuperpixelFeatMatrix(res);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; order; ++i) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    iftMatrix *neighHist = <a class="code" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a46cb8c16901601540794c7de4a352e1b">iftComputeSuperpixelFeaturesByNeighborHistogram</a>(igraph, baseHist, i+1);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    iftNormalizeSuperpixelFeatMatrix(neighHist);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    iftMatrix *aux = iftConcatenateSuperpixelFeatMatrix(res, neighHist);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    iftSwap(aux, res);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    iftDestroyMatrix(&amp;aux);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  iftDestroyMatrix(&amp;baseHist);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;}</div><div class="ttc" id="iftSuperpixelFeatures_8h_html_a46cb8c16901601540794c7de4a352e1b"><div class="ttname"><a href="../../d0/d68/iftSuperpixelFeatures_8h.html#a46cb8c16901601540794c7de4a352e1b">iftComputeSuperpixelFeaturesByNeighborHistogram</a></div><div class="ttdeci">iftMatrix * iftComputeSuperpixelFeaturesByNeighborHistogram(const iftSuperpixelIGraph *igraph, iftMatrix *spHistFeats, int neighDist)</div><div class="ttdoc">Computes contextual histogram for superpixels. </div><div class="ttdef"><b>Definition:</b> iftSuperpixelFeatures.c:452</div></div>
<div class="ttc" id="structiftSuperpixelIGraph_html_a6c2fb5eb399b42009da6255ec3ec0a44"><div class="ttname"><a href="../../d6/db9/structiftSuperpixelIGraph.html#a6c2fb5eb399b42009da6255ec3ec0a44">iftSuperpixelIGraph::refImg</a></div><div class="ttdeci">iftImage * refImg</div><div class="ttdef"><b>Definition:</b> iftHISF.h:48</div></div>
<div class="ttc" id="iftSuperpixelFeatures_8h_html_a2fda8cc0fec548ed7024c96f4ba39fed"><div class="ttname"><a href="../../d0/d68/iftSuperpixelFeatures_8h.html#a2fda8cc0fec548ed7024c96f4ba39fed">iftComputeSuperpixelFeaturesByBICHistogram</a></div><div class="ttdeci">iftMatrix * iftComputeSuperpixelFeaturesByBICHistogram(const iftImage *img, const iftImage *labelMap, int binsPerColor)</div><div class="ttdoc">Computes BIC histogram for superpixels. </div><div class="ttdef"><b>Definition:</b> iftSuperpixelFeatures.c:433</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a479907d9fdb582da74c8c001c1a11415"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a479907d9fdb582da74c8c001c1a11415">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByContextualColorHistogram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByContextualColorHistogram </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/db9/structiftSuperpixelIGraph.html">iftSuperpixelIGraph</a> *&#160;</td>
          <td class="paramname"><em>igraph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>binsPerColor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes color histogram at multiple superpixel distances. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January 5, 2017 </dd></dl>
<div class="fragment"><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;{</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  iftMatrix *baseHist = <a class="code" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a3956122192ce3cfb8af150c93e8cf270">iftComputeSuperpixelFeaturesByColorHistogram</a>(img, igraph-&gt;<a class="code" href="../../d6/db9/structiftSuperpixelIGraph.html#a6c2fb5eb399b42009da6255ec3ec0a44">refImg</a>, binsPerColor);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  iftMatrix *res = iftCopyMatrix(baseHist);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  iftNormalizeSuperpixelFeatMatrix(res);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; order; ++i) {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    iftMatrix *neighHist = <a class="code" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a46cb8c16901601540794c7de4a352e1b">iftComputeSuperpixelFeaturesByNeighborHistogram</a>(igraph, baseHist, i+1);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    iftNormalizeSuperpixelFeatMatrix(neighHist);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    iftMatrix *aux = iftConcatenateSuperpixelFeatMatrix(res, neighHist);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    iftSwap(aux, res);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    iftDestroyMatrix(&amp;aux);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  iftDestroyMatrix(&amp;baseHist);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;}</div><div class="ttc" id="iftSuperpixelFeatures_8h_html_a46cb8c16901601540794c7de4a352e1b"><div class="ttname"><a href="../../d0/d68/iftSuperpixelFeatures_8h.html#a46cb8c16901601540794c7de4a352e1b">iftComputeSuperpixelFeaturesByNeighborHistogram</a></div><div class="ttdeci">iftMatrix * iftComputeSuperpixelFeaturesByNeighborHistogram(const iftSuperpixelIGraph *igraph, iftMatrix *spHistFeats, int neighDist)</div><div class="ttdoc">Computes contextual histogram for superpixels. </div><div class="ttdef"><b>Definition:</b> iftSuperpixelFeatures.c:452</div></div>
<div class="ttc" id="structiftSuperpixelIGraph_html_a6c2fb5eb399b42009da6255ec3ec0a44"><div class="ttname"><a href="../../d6/db9/structiftSuperpixelIGraph.html#a6c2fb5eb399b42009da6255ec3ec0a44">iftSuperpixelIGraph::refImg</a></div><div class="ttdeci">iftImage * refImg</div><div class="ttdef"><b>Definition:</b> iftHISF.h:48</div></div>
<div class="ttc" id="iftSuperpixelFeatures_8h_html_a3956122192ce3cfb8af150c93e8cf270"><div class="ttname"><a href="../../d0/d68/iftSuperpixelFeatures_8h.html#a3956122192ce3cfb8af150c93e8cf270">iftComputeSuperpixelFeaturesByColorHistogram</a></div><div class="ttdeci">iftMatrix * iftComputeSuperpixelFeaturesByColorHistogram(const iftImage *img, const iftImage *labelMap, int binsPerColor)</div><div class="ttdoc">Computes color histogram for superpixels. </div><div class="ttdef"><b>Definition:</b> iftSuperpixelFeatures.c:416</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59cf5653577047928104f25014fe758f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59cf5653577047928104f25014fe758f">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByGeometricCenter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByGeometricCenter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>superpixelLabelMap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use geometric center as superpixel feature. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>August 1, 2017</dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000003">Todo:</a></b></dt><dd>Fill in params and preconditions. </dd></dl>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;{</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  assert(superpixelLabelMap != NULL);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// Build an MImage containing voxel coordinates as features</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d5/dec/structiftImage.html">iftImage</a> *map = superpixelLabelMap; <span class="comment">// shorthand</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">int</span> dim = <a class="code" href="../../da/d89/iftImage_8h.html#a10c39fd0119da8d6287098f9e1950c5d">iftIs3DImage</a>(map) ? 3 : 2;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="../../d4/d89/structiftMImage.html">iftMImage</a> *mimg = iftCreateMImage(map-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a0bbd7827516731bf81910e5e46904cb6">xsize</a>, map-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a940438838adf1ddd80c3057fdae847ef">ysize</a>, map-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a044215d2c7df412a81fedd913216e719">zsize</a>, dim);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; map-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a7aeea55b5b8596a61e1260829124b0e8">n</a>; ++p) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="../../da/dd3/structiftVoxel.html">iftVoxel</a> u = <a class="code" href="../../da/d89/iftImage_8h.html#adcd74824f09b06e1a3e750be7ba3ebf8">iftGetVoxelCoord</a>(map, p); </div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    mimg-&gt;band[0].val[p] = (float) u.x;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    mimg-&gt;band[1].val[p] = (<span class="keywordtype">float</span>) u.y;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (dim == 3)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      mimg-&gt;band[2].val[p] = (float) u.z;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// Use existing MImage Mean function to obtain superpixel mean</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  iftMatrix *mx = <a class="code" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a24a058d1a1a72f416288b63f65cb8b29">iftComputeSuperpixelFeaturesByMImageMean</a>(mimg, map);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  iftDestroyMImage(&amp;mimg);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">return</span> mx;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div><div class="ttc" id="structiftMImage_html"><div class="ttname"><a href="../../d4/d89/structiftMImage.html">iftMImage</a></div><div class="ttdoc">swig(extend = iftMImageExt.i, destroyer = iftDestroyMImage) </div><div class="ttdef"><b>Definition:</b> iftMImage.h:24</div></div>
<div class="ttc" id="iftImage_8h_html_a10c39fd0119da8d6287098f9e1950c5d"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#a10c39fd0119da8d6287098f9e1950c5d">iftIs3DImage</a></div><div class="ttdeci">static bool iftIs3DImage(const iftImage *img)</div><div class="ttdoc">Check if the image has 3D information. </div><div class="ttdef"><b>Definition:</b> iftImage.h:327</div></div>
<div class="ttc" id="structiftImage_html_a940438838adf1ddd80c3057fdae847ef"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a940438838adf1ddd80c3057fdae847ef">iftImage::ysize</a></div><div class="ttdeci">int ysize</div><div class="ttdef"><b>Definition:</b> iftImage.h:126</div></div>
<div class="ttc" id="structiftVoxel_html"><div class="ttname"><a href="../../da/dd3/structiftVoxel.html">iftVoxel</a></div><div class="ttdoc">3D point in the integer space. </div><div class="ttdef"><b>Definition:</b> iftBasicDataTypes.h:130</div></div>
<div class="ttc" id="iftSuperpixelFeatures_8h_html_a24a058d1a1a72f416288b63f65cb8b29"><div class="ttname"><a href="../../d0/d68/iftSuperpixelFeatures_8h.html#a24a058d1a1a72f416288b63f65cb8b29">iftComputeSuperpixelFeaturesByMImageMean</a></div><div class="ttdeci">iftMatrix * iftComputeSuperpixelFeaturesByMImageMean(const iftMImage *mimg, const iftImage *superpixelLabelMap)</div><div class="ttdoc">Use mean of mimage values as superpixel feature. </div><div class="ttdef"><b>Definition:</b> iftSuperpixelFeatures.c:227</div></div>
<div class="ttc" id="iftImage_8h_html_adcd74824f09b06e1a3e750be7ba3ebf8"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#adcd74824f09b06e1a3e750be7ba3ebf8">iftGetVoxelCoord</a></div><div class="ttdeci">iftVoxel iftGetVoxelCoord(const iftImage *img, int p)</div><div class="ttdoc">Gets the correspondent voxel to index p. </div></div>
<div class="ttc" id="structiftImage_html_a0bbd7827516731bf81910e5e46904cb6"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a0bbd7827516731bf81910e5e46904cb6">iftImage::xsize</a></div><div class="ttdeci">int xsize</div><div class="ttdef"><b>Definition:</b> iftImage.h:124</div></div>
<div class="ttc" id="structiftImage_html_a7aeea55b5b8596a61e1260829124b0e8"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a7aeea55b5b8596a61e1260829124b0e8">iftImage::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> iftImage.h:140</div></div>
<div class="ttc" id="structiftImage_html_a044215d2c7df412a81fedd913216e719"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a044215d2c7df412a81fedd913216e719">iftImage::zsize</a></div><div class="ttdeci">int zsize</div><div class="ttdef"><b>Definition:</b> iftImage.h:128</div></div>
<div class="ttc" id="structiftImage_html"><div class="ttname"><a href="../../d5/dec/structiftImage.html">iftImage</a></div><div class="ttdoc">iftImage definition and prototypes. </div><div class="ttdef"><b>Definition:</b> iftImage.h:113</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a24a058d1a1a72f416288b63f65cb8b29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24a058d1a1a72f416288b63f65cb8b29">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByMImageMean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByMImageMean </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/d89/structiftMImage.html">iftMImage</a> *&#160;</td>
          <td class="paramname"><em>mimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>superpixelLabelMap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use mean of mimage values as superpixel feature. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 27, 2017</dd></dl>
<p>For each superpixel, takes the mean (average) value of its pixels' feature vectors (i.e. <code>mimg</code> values) as superpixel feature vector.</p>
<p>For now we assume that the number of pixels in each superpixel is small enough so that naive float accumulation does not lead to significant errors.</p>
<p>The returned <code><a class="el" href="../../dd/d29/structiftDataSet.html" title="Dataset structure for pattern recognition. ">iftDataSet</a></code> is owned by the caller. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d1/d86/iftDataSet_8h.html#aae7b9c78b75f04e57706682702809573" title="Destroys a dataset object (and destroy their Sample Feature Vectors). ">iftDestroyDataSet()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mimg</td><td>Base <code><a class="el" href="../../d4/d89/structiftMImage.html" title="swig(extend = iftMImageExt.i, destroyer = iftDestroyMImage) ">iftMImage</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">superpixelLabelMap</td><td>Some superpixel segmentation of mimg. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Data matrix where each row corresponds to the corresponding </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>mimg</code> and <code>superpixelLabelMap</code> are not NULL and share the same spatial domain. </dd>
<dd>
<code>superpixelLabelMap</code> does not contain label gaps. </dd></dl>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  assert(mimg != NULL &amp;&amp; superpixelLabelMap != NULL);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  assert(mimg-&gt;xsize == superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a0bbd7827516731bf81910e5e46904cb6">xsize</a>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  assert(mimg-&gt;ysize == superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a940438838adf1ddd80c3057fdae847ef">ysize</a>);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  assert(mimg-&gt;zsize == superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a044215d2c7df412a81fedd913216e719">zsize</a>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="comment">// TODO assert(check label map consistency) </span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">int</span> nSuperpixels = <a class="code" href="../../da/d89/iftImage_8h.html#a3ff31caa90348c2bc163738acda2fad3">iftMaximumValue</a>(superpixelLabelMap);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  iftMatrix *mx = iftCreateMatrix(mimg-&gt;m, nSuperpixels);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">int</span> *pixelCount = <a class="code" href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a>(nSuperpixels);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">/* Sum pixel features for each superpixel with </span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">   *   naive float accumulation, O(n) error. */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; mimg-&gt;n; ++p) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[p] == 0)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">int</span> row = superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[p] - 1;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; mimg-&gt;m; ++f)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      mx-&gt;val[iftGetMatrixIndex(mx,f,row)] += mimg-&gt;band[f].val[p];</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    pixelCount[row] += 1;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; nSuperpixels; ++row)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; mimg-&gt;m; ++f)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      mx-&gt;val[iftGetMatrixIndex(mx,f,row)] /= pixelCount[row];</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  free(pixelCount);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">return</span> mx;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="ttc" id="group__Memory_html_ga27f8370c9e4c937311d70fad35e70116"><div class="ttname"><a href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a></div><div class="ttdeci">int * iftAllocIntArray(long n)</div><div class="ttdoc">Allocates a Char Array (string) with n positions. </div></div>
<div class="ttc" id="structiftImage_html_a940438838adf1ddd80c3057fdae847ef"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a940438838adf1ddd80c3057fdae847ef">iftImage::ysize</a></div><div class="ttdeci">int ysize</div><div class="ttdef"><b>Definition:</b> iftImage.h:126</div></div>
<div class="ttc" id="structiftImage_html_a0bbd7827516731bf81910e5e46904cb6"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a0bbd7827516731bf81910e5e46904cb6">iftImage::xsize</a></div><div class="ttdeci">int xsize</div><div class="ttdef"><b>Definition:</b> iftImage.h:124</div></div>
<div class="ttc" id="structiftImage_html_acd0db223f77f5e403a1431ebc2636bf1"><div class="ttname"><a href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">iftImage::val</a></div><div class="ttdeci">int * val</div><div class="ttdef"><b>Definition:</b> iftImage.h:115</div></div>
<div class="ttc" id="iftImage_8h_html_a3ff31caa90348c2bc163738acda2fad3"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#a3ff31caa90348c2bc163738acda2fad3">iftMaximumValue</a></div><div class="ttdeci">int iftMaximumValue(const iftImage *img)</div><div class="ttdoc">swig() </div></div>
<div class="ttc" id="structiftImage_html_a044215d2c7df412a81fedd913216e719"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a044215d2c7df412a81fedd913216e719">iftImage::zsize</a></div><div class="ttdeci">int zsize</div><div class="ttdef"><b>Definition:</b> iftImage.h:128</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ade3bcc6fe70628fa47887337471833"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ade3bcc6fe70628fa47887337471833">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByMImageMedoid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByMImageMedoid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/d89/structiftMImage.html">iftMImage</a> *&#160;</td>
          <td class="paramname"><em>mimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>superpixelLabelMap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use medoid of pixel values as superpixel feature. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 27, 2017</dd></dl>
<p>For each superpixel, calculate the mean (average) value of its pixels' feature vectors (i.e. <code>mimg</code> values) and then use the pixel feature vector closest to the mean as the superpixel feature vector.</p>
<p>The returned <code><a class="el" href="../../dd/d29/structiftDataSet.html" title="Dataset structure for pattern recognition. ">iftDataSet</a></code> is owned by the caller. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d1/d86/iftDataSet_8h.html#aae7b9c78b75f04e57706682702809573" title="Destroys a dataset object (and destroy their Sample Feature Vectors). ">iftDestroyDataSet()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mimg</td><td>Base <code><a class="el" href="../../d4/d89/structiftMImage.html" title="swig(extend = iftMImageExt.i, destroyer = iftDestroyMImage) ">iftMImage</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">superpixelLabelMap</td><td>Some superpixel segmentation of mimg. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Data matrix where each row corresponds to the corresponding </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>mimg</code> and <code>superpixelLabelMap</code> are not NULL and share the same spatial domain. </dd>
<dd>
<code>superpixelLabelMap</code> does not contain label gaps. </dd></dl>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  assert(mimg != NULL &amp;&amp; superpixelLabelMap != NULL);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  assert(mimg-&gt;xsize == superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a0bbd7827516731bf81910e5e46904cb6">xsize</a>);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  assert(mimg-&gt;ysize == superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a940438838adf1ddd80c3057fdae847ef">ysize</a>);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  assert(mimg-&gt;zsize == superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a044215d2c7df412a81fedd913216e719">zsize</a>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// TODO assert(check label map consistency) </span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// Piggyback from the mean calculation</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  iftMatrix *mx = <a class="code" href="../../d0/d68/iftSuperpixelFeatures_8h.html#a24a058d1a1a72f416288b63f65cb8b29">iftComputeSuperpixelFeaturesByMImageMean</a>(mimg, superpixelLabelMap);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// Keep track of currently known closest pixel for each superpixel</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordtype">int</span> *medoidCandidate = <a class="code" href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a>(mx-&gt;nrows);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">float</span> *candidateDist = <a class="code" href="../../de/d85/group__Memory.html#ga241f5543f05614a13e66b9fc5b0f8f27">iftAllocFloatArray</a>(mx-&gt;nrows);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mx-&gt;nrows; ++i) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    medoidCandidate[i] = -1;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    candidateDist[i] = FLT_MAX;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">// Try to update closest pixel for each pixel</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; mimg-&gt;n; ++p) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">int</span> row = superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[p] - 1;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (row &lt; 0)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// Compute distance from its superpixel mean</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../d3/dd1/structdist.html">dist</a> = 0.0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; mimg-&gt;m; ++f) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordtype">float</span> a = mimg-&gt;band[f].val[p];</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordtype">float</span> b = mx-&gt;val[iftGetMatrixIndex(mx,f,row)];</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <a class="code" href="../../d3/dd1/structdist.html">dist</a> += (a-b)*(a-b);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// Update on improvement</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d3/dd1/structdist.html">dist</a> &lt; candidateDist[row]) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      medoidCandidate[row] = p;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      candidateDist[row] = <a class="code" href="../../d3/dd1/structdist.html">dist</a>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">// Overwrite mean matrix with medoids to avoid new allocation</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; mx-&gt;nrows; ++row) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; mimg-&gt;m; ++f) {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordtype">float</span> feat = mimg-&gt;band[f].val[medoidCandidate[row]];</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      mx-&gt;val[iftGetMatrixIndex(mx,f,row)] = feat;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  free(medoidCandidate);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  free(candidateDist);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">return</span>(mx);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div><div class="ttc" id="group__Memory_html_ga241f5543f05614a13e66b9fc5b0f8f27"><div class="ttname"><a href="../../de/d85/group__Memory.html#ga241f5543f05614a13e66b9fc5b0f8f27">iftAllocFloatArray</a></div><div class="ttdeci">float * iftAllocFloatArray(long n)</div><div class="ttdoc">Allocates a Char Array (string) with n positions. </div></div>
<div class="ttc" id="group__Memory_html_ga27f8370c9e4c937311d70fad35e70116"><div class="ttname"><a href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a></div><div class="ttdeci">int * iftAllocIntArray(long n)</div><div class="ttdoc">Allocates a Char Array (string) with n positions. </div></div>
<div class="ttc" id="structiftImage_html_a940438838adf1ddd80c3057fdae847ef"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a940438838adf1ddd80c3057fdae847ef">iftImage::ysize</a></div><div class="ttdeci">int ysize</div><div class="ttdef"><b>Definition:</b> iftImage.h:126</div></div>
<div class="ttc" id="iftSuperpixelFeatures_8h_html_a24a058d1a1a72f416288b63f65cb8b29"><div class="ttname"><a href="../../d0/d68/iftSuperpixelFeatures_8h.html#a24a058d1a1a72f416288b63f65cb8b29">iftComputeSuperpixelFeaturesByMImageMean</a></div><div class="ttdeci">iftMatrix * iftComputeSuperpixelFeaturesByMImageMean(const iftMImage *mimg, const iftImage *superpixelLabelMap)</div><div class="ttdoc">Use mean of mimage values as superpixel feature. </div><div class="ttdef"><b>Definition:</b> iftSuperpixelFeatures.c:227</div></div>
<div class="ttc" id="structdist_html"><div class="ttname"><a href="../../d3/dd1/structdist.html">dist</a></div></div>
<div class="ttc" id="structiftImage_html_a0bbd7827516731bf81910e5e46904cb6"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a0bbd7827516731bf81910e5e46904cb6">iftImage::xsize</a></div><div class="ttdeci">int xsize</div><div class="ttdef"><b>Definition:</b> iftImage.h:124</div></div>
<div class="ttc" id="structiftImage_html_acd0db223f77f5e403a1431ebc2636bf1"><div class="ttname"><a href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">iftImage::val</a></div><div class="ttdeci">int * val</div><div class="ttdef"><b>Definition:</b> iftImage.h:115</div></div>
<div class="ttc" id="structiftImage_html_a044215d2c7df412a81fedd913216e719"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a044215d2c7df412a81fedd913216e719">iftImage::zsize</a></div><div class="ttdeci">int zsize</div><div class="ttdef"><b>Definition:</b> iftImage.h:128</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a46cb8c16901601540794c7de4a352e1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46cb8c16901601540794c7de4a352e1b">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByNeighborHistogram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByNeighborHistogram </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/db9/structiftSuperpixelIGraph.html">iftSuperpixelIGraph</a> *&#160;</td>
          <td class="paramname"><em>igraph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">iftMatrix *&#160;</td>
          <td class="paramname"><em>spHistFeats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>neighDist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes contextual histogram for superpixels. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>January 5, 2017</dd></dl>
<p>By contextual we mean, for each superpixel we compute a histogram with the pixels from superpixels at EXACTLY <code>neighDist</code> of the base superpixel.</p>
<p>It works for any kind of base superpixel histogram (e.g. conventional color histogram, BIC).</p>
<p>All involved histogram MUST NOT be normalized.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">spHistFeats</td><td>Pre-computed histogram for each superpixel. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  iftMatrix *res = iftCreateMatrix(spHistFeats-&gt;ncols, spHistFeats-&gt;nrows);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordtype">int</span> *spMarker = <a class="code" href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a>(igraph-&gt;<a class="code" href="../../d6/db9/structiftSuperpixelIGraph.html#a06904e14b592bf34df5024a844d05fac">nNodes</a>);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/da1/structnode.html">node</a> = 0; <a class="code" href="../../d5/da1/structnode.html">node</a> &lt; igraph-&gt;<a class="code" href="../../d6/db9/structiftSuperpixelIGraph.html#a06904e14b592bf34df5024a844d05fac">nNodes</a>; ++<a class="code" href="../../d5/da1/structnode.html">node</a>) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">int</span> mark = <a class="code" href="../../d5/da1/structnode.html">node</a> + 1; <span class="comment">// Color that implicitly resets for each node</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="../../d2/d8c/structiftSet.html">iftSet</a> *spSet = NULL;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    iftInsertSet(&amp;spSet, <a class="code" href="../../d5/da1/structnode.html">node</a>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    spMarker[<a class="code" href="../../d5/da1/structnode.html">node</a>] = mark;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// BFS-like search for the neighbors at specified distance</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d3/dd1/structdist.html">dist</a> = 0; <a class="code" href="../../d3/dd1/structdist.html">dist</a> &lt; neighDist; ++<a class="code" href="../../d3/dd1/structdist.html">dist</a>) {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <a class="code" href="../../d2/d8c/structiftSet.html">iftSet</a> *auxSet = NULL;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">while</span>(spSet != NULL) {</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordtype">int</span> s = iftRemoveSet(&amp;spSet);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="../../d2/d8c/structiftSet.html">iftSet</a> *adj = igraph-&gt;<a class="code" href="../../d6/db9/structiftSuperpixelIGraph.html#a923e491731007ac0fcfa9273647f0ddf">nodeAdj</a>[s];</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">for</span>(; adj != NULL; adj = adj-&gt;next) {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          <span class="keywordtype">int</span> t = adj-&gt;elem;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          <span class="keywordflow">if</span> (spMarker[t] &lt; mark) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            spMarker[t] = mark;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            iftInsertSet(&amp;auxSet, t);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;          }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      spSet = auxSet;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    }</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// Add neighbor histogram counts to the result matrix</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">float</span> *nodeFeat = iftMatrixRowPointer(res, <a class="code" href="../../d5/da1/structnode.html">node</a>);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">while</span> (spSet != NULL) {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordtype">int</span> s = iftRemoveSet(&amp;spSet);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordtype">float</span> *neighFeat = iftMatrixRowPointer(spHistFeats, s);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; res-&gt;ncols; ++col)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        nodeFeat[col] += neighFeat[col];</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div><div class="ttc" id="structnode_html"><div class="ttname"><a href="../../d5/da1/structnode.html">node</a></div><div class="ttdoc">Structure to produce a linked list of nodes. </div></div>
<div class="ttc" id="structiftSuperpixelIGraph_html_a923e491731007ac0fcfa9273647f0ddf"><div class="ttname"><a href="../../d6/db9/structiftSuperpixelIGraph.html#a923e491731007ac0fcfa9273647f0ddf">iftSuperpixelIGraph::nodeAdj</a></div><div class="ttdeci">iftSet ** nodeAdj</div><div class="ttdef"><b>Definition:</b> iftHISF.h:33</div></div>
<div class="ttc" id="structiftSet_html"><div class="ttname"><a href="../../d2/d8c/structiftSet.html">iftSet</a></div><div class="ttdef"><b>Definition:</b> iftSet.h:13</div></div>
<div class="ttc" id="group__Memory_html_ga27f8370c9e4c937311d70fad35e70116"><div class="ttname"><a href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a></div><div class="ttdeci">int * iftAllocIntArray(long n)</div><div class="ttdoc">Allocates a Char Array (string) with n positions. </div></div>
<div class="ttc" id="structdist_html"><div class="ttname"><a href="../../d3/dd1/structdist.html">dist</a></div></div>
<div class="ttc" id="structiftSuperpixelIGraph_html_a06904e14b592bf34df5024a844d05fac"><div class="ttname"><a href="../../d6/db9/structiftSuperpixelIGraph.html#a06904e14b592bf34df5024a844d05fac">iftSuperpixelIGraph::nNodes</a></div><div class="ttdeci">int nNodes</div><div class="ttdef"><b>Definition:</b> iftHISF.h:31</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a50a03c05981708fab9dfdf71fdbde4e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50a03c05981708fab9dfdf71fdbde4e7">&#9670;&nbsp;</a></span>iftComputeSuperpixelFeaturesByRegionCovarianceMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iftMatrix* iftComputeSuperpixelFeaturesByRegionCovarianceMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/dec/structiftImage.html">iftImage</a> *&#160;</td>
          <td class="paramname"><em>superpixelLabelMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const iftMatrix *&#160;</td>
          <td class="paramname"><em>pixelFeats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use superpixel covariance matrix as feature. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>August 2, 2017</dd></dl>
<p>The result rows represent the covariance matrix as a 1D array. The original shape is easy to recover as we are dealing with a square matrix.</p>
<p>We assume a concatenation of pixel features have been computed beforehand.</p>
<p>The returned <code>iftMatrix</code> is owned by the caller. </p><dl class="section see"><dt>See also</dt><dd>iftDestroyMatrix() </dd>
<dd>
<a class="el" href="../../d0/d68/iftSuperpixelFeatures_8h.html#aabfcbc8d3ad500cc3aeb6cbb72a9b2b6" title="Distance function for covariance matrices. ">iftCovarianceDistance()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">superpixelLabelMap</td><td>Some superpixel segmentation of mimg. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pixelFeats</td><td><a class="el" href="../../d2/d90/structPixel.html">Pixel</a> level features over the same domain. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The (nSuperpixels x (pixelFeats-&gt;ncols)^2) feature matrix of convariance matrix features.</dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>All parameters are not NULL. </dd>
<dd>
There are features for all pixels (i.e. pixelFeats-&gt;nrows == superpixelLabelMap-&gt;n) </dd></dl>
<div class="fragment"><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;{</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  assert(superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a7aeea55b5b8596a61e1260829124b0e8">n</a> == pixelFeats-&gt;nrows);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// Compute superpixel information</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordtype">int</span> nSuperpixels = <a class="code" href="../../da/d89/iftImage_8h.html#a3ff31caa90348c2bc163738acda2fad3">iftMaximumValue</a>(superpixelLabelMap);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">int</span> *superpixelSize = <a class="code" href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a>(nSuperpixels);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#a7aeea55b5b8596a61e1260829124b0e8">n</a>; ++p) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">int</span> label = superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[p] - 1;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">if</span> (label &lt; 0)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// TODO check if should change to label</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    superpixelSize[p] += 1;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">// Build a dataset of pixel features for each superpixel</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="../../dd/d29/structiftDataSet.html">iftDataSet</a> **Zr = <a class="code" href="../../de/d85/group__Memory.html#gab243c7e5fbc559cf293653991c8cd369">iftAlloc</a>(nSuperpixels, <span class="keyword">sizeof</span>(*Zr));</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nSuperpixels; ++i)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    Zr[i] = <a class="code" href="../../d1/d86/iftDataSet_8h.html#ab179aaed152c6d1782322e93a419a0e6">iftCreateDataSet</a>(superpixelSize[i], pixelFeats-&gt;ncols);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordtype">int</span> *spIndex = <a class="code" href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a>(nSuperpixels);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; pixelFeats-&gt;nrows; ++row) {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">int</span> label = superpixelLabelMap-&gt;<a class="code" href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">val</a>[row] - 1;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (label &lt; 0)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; pixelFeats-&gt;ncols; ++f) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      Zr[label]-&gt;sample[spIndex[label]].feat[f] =</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        pixelFeats-&gt;val[iftGetMatrixIndex(pixelFeats,f,row)];</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    Zr[label]-&gt;sample[spIndex[label]].status = IFT_TRAIN; </div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    spIndex[label] += 1;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  }</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">// Build covariance matrix for all superpixels</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordtype">int</span> covMxSize = pixelFeats-&gt;ncols * pixelFeats-&gt;ncols;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  iftMatrix *res = iftCreateMatrix(covMxSize, nSuperpixels);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nSuperpixels; ++i) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="../../dd/d29/structiftDataSet.html">iftDataSet</a> *Zrc = iftCentralizeDataSet(Zr[i]);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    iftMatrix *covMx = <a class="code" href="../../d1/d86/iftDataSet_8h.html#ad4d8e076673959f36d95cda319f49960">iftDatasetCovarianceMatrix</a>(Zrc);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    assert(covMx-&gt;n == covMxSize); <span class="comment">// sanity test</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// We read covariance matrix as 1D array</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; covMxSize; ++f)</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      res-&gt;val[iftGetMatrixIndex(res,f,i)] = covMx-&gt;val[f];</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="../../d1/d86/iftDataSet_8h.html#aae7b9c78b75f04e57706682702809573">iftDestroyDataSet</a>(&amp;(Zr[i]));</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="../../d1/d86/iftDataSet_8h.html#aae7b9c78b75f04e57706682702809573">iftDestroyDataSet</a>(&amp;Zrc);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    iftDestroyMatrix(&amp;covMx);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  </div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">// Clean up</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  free(Zr);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  free(superpixelSize);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  free(spIndex);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div><div class="ttc" id="group__Memory_html_ga27f8370c9e4c937311d70fad35e70116"><div class="ttname"><a href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a></div><div class="ttdeci">int * iftAllocIntArray(long n)</div><div class="ttdoc">Allocates a Char Array (string) with n positions. </div></div>
<div class="ttc" id="iftDataSet_8h_html_ab179aaed152c6d1782322e93a419a0e6"><div class="ttname"><a href="../../d1/d86/iftDataSet_8h.html#ab179aaed152c6d1782322e93a419a0e6">iftCreateDataSet</a></div><div class="ttdeci">iftDataSet * iftCreateDataSet(int nsamples, int nfeats)</div><div class="ttdoc">Creates an empty dataset. </div></div>
<div class="ttc" id="iftDataSet_8h_html_ad4d8e076673959f36d95cda319f49960"><div class="ttname"><a href="../../d1/d86/iftDataSet_8h.html#ad4d8e076673959f36d95cda319f49960">iftDatasetCovarianceMatrix</a></div><div class="ttdeci">iftMatrix * iftDatasetCovarianceMatrix(iftDataSet *Z)</div><div class="ttdoc">Computes the covariance matrix of the dataset features. </div></div>
<div class="ttc" id="group__Memory_html_gab243c7e5fbc559cf293653991c8cd369"><div class="ttname"><a href="../../de/d85/group__Memory.html#gab243c7e5fbc559cf293653991c8cd369">iftAlloc</a></div><div class="ttdeci">void * iftAlloc(long n, long sz)</div><div class="ttdoc">Allocate n memory blocks of size sz. See also iftFree(). </div></div>
<div class="ttc" id="iftDataSet_8h_html_aae7b9c78b75f04e57706682702809573"><div class="ttname"><a href="../../d1/d86/iftDataSet_8h.html#aae7b9c78b75f04e57706682702809573">iftDestroyDataSet</a></div><div class="ttdeci">void iftDestroyDataSet(iftDataSet **Z)</div><div class="ttdoc">Destroys a dataset object (and destroy their Sample Feature Vectors). </div></div>
<div class="ttc" id="structiftDataSet_html"><div class="ttname"><a href="../../dd/d29/structiftDataSet.html">iftDataSet</a></div><div class="ttdoc">Dataset structure for pattern recognition. </div><div class="ttdef"><b>Definition:</b> iftDataSet.h:190</div></div>
<div class="ttc" id="structiftImage_html_acd0db223f77f5e403a1431ebc2636bf1"><div class="ttname"><a href="../../d5/dec/structiftImage.html#acd0db223f77f5e403a1431ebc2636bf1">iftImage::val</a></div><div class="ttdeci">int * val</div><div class="ttdef"><b>Definition:</b> iftImage.h:115</div></div>
<div class="ttc" id="iftImage_8h_html_a3ff31caa90348c2bc163738acda2fad3"><div class="ttname"><a href="../../da/d89/iftImage_8h.html#a3ff31caa90348c2bc163738acda2fad3">iftMaximumValue</a></div><div class="ttdeci">int iftMaximumValue(const iftImage *img)</div><div class="ttdoc">swig() </div></div>
<div class="ttc" id="structiftImage_html_a7aeea55b5b8596a61e1260829124b0e8"><div class="ttname"><a href="../../d5/dec/structiftImage.html#a7aeea55b5b8596a61e1260829124b0e8">iftImage::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> iftImage.h:140</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aabfcbc8d3ad500cc3aeb6cbb72a9b2b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabfcbc8d3ad500cc3aeb6cbb72a9b2b6">&#9670;&nbsp;</a></span>iftCovarianceDistance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float iftCovarianceDistance </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Distance function for covariance matrices. </p>
<dl class="section author"><dt>Author</dt><dd>Felipe Lemes Galvao </dd></dl>
<dl class="section date"><dt>Date</dt><dd>August 2, 2017</dd></dl>
<p>Covariance metric as used on <a href="https://doi.org/10.1007/11744047_45">https://doi.org/10.1007/11744047_45</a></p>
<p>In general, both inputs must represent square matrices that are symmetric or Hermitian, and <code>f2</code> must be positive definite. Covariance matrices by definition meet those conditions.</p>
<p>This distance function is computationally expensive so it is expected that the input covariance matrices are relatively small.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">f1</td><td>Input feature vector 1. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f2</td><td>Input feature vector 2. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>Ignored (to match iftArcWeightFun signature). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Feature vector sizes. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="comment">// Find order = ncols = nrows = sqrt(n)</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">int</span> order = (int) round(sqrt(n));</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  assert(order * order == n);</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="comment">// We need a copy as the matrices values will be destroyed</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="comment">// No need to switch to column major representation (symmetric)</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordtype">float</span> *A = <a class="code" href="../../de/d85/group__Memory.html#ga241f5543f05614a13e66b9fc5b0f8f27">iftAllocFloatArray</a>(n);</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <span class="keywordtype">float</span> *B = <a class="code" href="../../de/d85/group__Memory.html#ga241f5543f05614a13e66b9fc5b0f8f27">iftAllocFloatArray</a>(n);</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    A[i] = f1[i];</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    B[i] = f2[i];</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  }</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="comment">// Param to choose the form A*x = (lambda)*B*x</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordtype">int</span> type = 1;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="comment">// Eigenvalues, the values we want to compute the distance</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">float</span> *lambda = <a class="code" href="../../de/d85/group__Memory.html#ga241f5543f05614a13e66b9fc5b0f8f27">iftAllocFloatArray</a>(n);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="comment">// Work arrays (minimum values)</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordtype">int</span> lwork = 2*order + 1;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">float</span> *work = <a class="code" href="../../de/d85/group__Memory.html#ga241f5543f05614a13e66b9fc5b0f8f27">iftAllocFloatArray</a>(lwork);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordtype">int</span> liwork = 1;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">int</span> *iwork = <a class="code" href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a>(liwork); </div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// Execution feedback</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span> info = -1;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  ssygvd_(</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      &amp;type, <span class="comment">// Eigenvalue problem choice (A*x = lambda*B*x)</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="stringliteral">&quot;N&quot;</span>, <span class="comment">// Compute eigenvalues only</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="stringliteral">&quot;U&quot;</span>, <span class="comment">// Store upper triangle of the symmetric matrices</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      &amp;order, <span class="comment">// Order of matrices</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      A, <span class="comment">// Input n x n matrix A</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      &amp;order, <span class="comment">// A-&gt;nrows</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      B, <span class="comment">// Input n x n matrix B</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      &amp;order, <span class="comment">// B-&gt;nrows</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      lambda, <span class="comment">// Output array of eigenvalues in ascending order</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      work,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      &amp;lwork,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      iwork,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      &amp;liwork,</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      &amp;info); <span class="comment">// Return code, 0 means sucess</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; order; ++i)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    printf(<span class="stringliteral">&quot;Lambda[%d] = %f\n&quot;</span>, i, lambda[i]);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// Check for errors</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (info != 0) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    printf(<span class="stringliteral">&quot;ssygvd_ returned error code %d.\n&quot;</span>, info);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    exit(1);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// Compute actual distance</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../d3/dd1/structdist.html">dist</a> = 0.0;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; order; ++i) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    assert(lambda[i] &gt;= 0.0);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">double</span> ln = log(lambda[i]);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="../../d3/dd1/structdist.html">dist</a> += (ln * ln);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="../../d3/dd1/structdist.html">dist</a> = sqrt(<a class="code" href="../../d3/dd1/structdist.html">dist</a>);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// Clean up</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  free(A);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  free(B);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  free(lambda);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  free(work);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  free(iwork);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d3/dd1/structdist.html">dist</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div><div class="ttc" id="group__Memory_html_ga241f5543f05614a13e66b9fc5b0f8f27"><div class="ttname"><a href="../../de/d85/group__Memory.html#ga241f5543f05614a13e66b9fc5b0f8f27">iftAllocFloatArray</a></div><div class="ttdeci">float * iftAllocFloatArray(long n)</div><div class="ttdoc">Allocates a Char Array (string) with n positions. </div></div>
<div class="ttc" id="group__Memory_html_ga27f8370c9e4c937311d70fad35e70116"><div class="ttname"><a href="../../de/d85/group__Memory.html#ga27f8370c9e4c937311d70fad35e70116">iftAllocIntArray</a></div><div class="ttdeci">int * iftAllocIntArray(long n)</div><div class="ttdoc">Allocates a Char Array (string) with n positions. </div></div>
<div class="ttc" id="structdist_html"><div class="ttname"><a href="../../d3/dd1/structdist.html">dist</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Aug 18 2018 16:22:29 for libIFT by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
