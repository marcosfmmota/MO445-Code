<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libIFT: huge_to_large Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://www.mathjax.org/mathjax/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libIFT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">huge_to_large Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<div class="textblock"><pre class="fragment">Split dataset methods.

See a json file config demo in python ift/demo/NegativeMining/neg_mining/json/split_params.json
</pre> </div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6c3c1395c2d47755a9731dfe33508a49"><td class="memItemLeft" align="right" valign="top"><a id="a6c3c1395c2d47755a9731dfe33508a49"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>print_error</b> (error_msg, function)</td></tr>
<tr class="separator:a6c3c1395c2d47755a9731dfe33508a49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa9b1fe2358fea169a4983a9396deb15"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d65/namespacehuge__to__large.html#aaa9b1fe2358fea169a4983a9396deb15">validate_pos_and_neg_sets</a> (pos_train_idxs, pos_test_idxs, neg_idxs)</td></tr>
<tr class="separator:aaa9b1fe2358fea169a4983a9396deb15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac06a4945b6df4807a697b7bd76c17efb"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d65/namespacehuge__to__large.html#ac06a4945b6df4807a697b7bd76c17efb">save_idx_set</a> (idxs, filename)</td></tr>
<tr class="separator:ac06a4945b6df4807a697b7bd76c17efb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad84432fb8bce89b257e064005df9586b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d65/namespacehuge__to__large.html#ad84432fb8bce89b257e064005df9586b">split_dataset</a> (y, n_pos_labels, n_imgs_per_label, pos_train_perc)</td></tr>
<tr class="separator:ad84432fb8bce89b257e064005df9586b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dcfb3fb13e79c775ce36d69f574cc31"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d65/namespacehuge__to__large.html#a1dcfb3fb13e79c775ce36d69f574cc31">build_label_dict</a> (y, idxs)</td></tr>
<tr class="separator:a1dcfb3fb13e79c775ce36d69f574cc31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e20f74b4b3db6d6d86015a4e2c7cd3"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d65/namespacehuge__to__large.html#a97e20f74b4b3db6d6d86015a4e2c7cd3">random_neg_set</a> (idxs, met_params)</td></tr>
<tr class="separator:a97e20f74b4b3db6d6d86015a4e2c7cd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2419e8161d58dfda842659f8f146efa1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d65/namespacehuge__to__large.html#a2419e8161d58dfda842659f8f146efa1">random_pl_neg_set</a> (y, idxs, met_params)</td></tr>
<tr class="separator:a2419e8161d58dfda842659f8f146efa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f31ea9d865c3e5f35c715e35e9d9e5a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d65/namespacehuge__to__large.html#a8f31ea9d865c3e5f35c715e35e9d9e5a">kmeans_neg_set</a> (y, idxs, met_params)</td></tr>
<tr class="separator:a8f31ea9d865c3e5f35c715e35e9d9e5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6709dca0cc9fd9c1047242792498d972"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d65/namespacehuge__to__large.html#a6709dca0cc9fd9c1047242792498d972">main</a> ()</td></tr>
<tr class="separator:a6709dca0cc9fd9c1047242792498d972"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1dcfb3fb13e79c775ce36d69f574cc31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dcfb3fb13e79c775ce36d69f574cc31">&#9670;&nbsp;</a></span>build_label_dict()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def huge_to_large.build_label_dict </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>idxs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Build a dict with the idxs from y of each label.


Parameters
----------
y: numpy array with shape (n_samples,)
    Label set.

idxs: numpy array
    Set with the indices of negative samples previously chosen.
    These indices are related with y.


Returns
-------
sample_idxs: dict
    Dictionary where each key corresponds to a label that stores the idxs from the sample of that label.
    The idxs are realeted to y.
</pre> <div class="fragment"><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">def </span>build_label_dict(y, idxs):</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Build a dict with the idxs from y of each label.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="stringliteral">    Parameters</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="stringliteral">    ----------</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="stringliteral">    y: numpy array with shape (n_samples,)</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="stringliteral">        Label set.</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="stringliteral">    idxs: numpy array</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="stringliteral">        Set with the indices of negative samples previously chosen.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="stringliteral">        These indices are related with y.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="stringliteral">    Returns</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="stringliteral">    -------</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="stringliteral">    sample_idxs: dict</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="stringliteral">        Dictionary where each key corresponds to a label that stores the idxs from the sample of that label.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="stringliteral">        The idxs are realeted to y.</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    unique_labels = np.unique(y[idxs]) <span class="comment"># get all labels from the negatives</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    sample_idxs   = dict()</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment"># initialize the dict</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">for</span> label <span class="keywordflow">in</span> unique_labels:</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        sample_idxs[label] = []</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment"># assign the idx to its respective label</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> idxs:</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        sample_idxs[y[idx]].append(idx)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">return</span> sample_idxs</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a8f31ea9d865c3e5f35c715e35e9d9e5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f31ea9d865c3e5f35c715e35e9d9e5a">&#9670;&nbsp;</a></span>kmeans_neg_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def huge_to_large.kmeans_neg_set </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>idxs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>met_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Split the Negative Set by kmeans.
Clusters each individual/label in &lt;n_clusters&gt; clusters and selects &lt;n_neg_imgs_per_label&gt; images
per label/class/individual following the idea:
    - Get the nearest elements from each centroid until reaching &lt;n_neg_imgs_per_label&gt;.

Parameters
----------   
y: numpy array with shape (n_samples,)
    Label set.

idxs: numpy array
    Set with the indices of negative samples previously chosen.
    These indices are related with y.

met_params: dict
    "dataset": string
        Dataset with the features which will be used for clustering.

    "n_clusters": int
        Number of clusters that will be used.

    "n_neg_imgs_per_label": int
        Number of negative images per individual/label required.

    "neg_set_fname": string
        Filename which will be used to save the neg set.

Notes
-----
If the number of images per class required is greater than the total number of images per class, 
an error message will be printed and the program will be terminated.
</pre> <div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keyword">def </span>kmeans_neg_set(y, idxs, met_params):</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Split the Negative Set by kmeans.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="stringliteral">    Clusters each individual/label in &lt;n_clusters&gt; clusters and selects &lt;n_neg_imgs_per_label&gt; images</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="stringliteral">    per label/class/individual following the idea:</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="stringliteral">        - Get the nearest elements from each centroid until reaching &lt;n_neg_imgs_per_label&gt;.</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="stringliteral">    Parameters</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="stringliteral">    ----------   </span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="stringliteral">    y: numpy array with shape (n_samples,)</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="stringliteral">        Label set.</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="stringliteral">    idxs: numpy array</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="stringliteral">        Set with the indices of negative samples previously chosen.</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="stringliteral">        These indices are related with y.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="stringliteral">    met_params: dict</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="stringliteral">        &quot;dataset&quot;: string</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="stringliteral">            Dataset with the features which will be used for clustering.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="stringliteral">        &quot;n_clusters&quot;: int</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="stringliteral">            Number of clusters that will be used.</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="stringliteral">        &quot;n_neg_imgs_per_label&quot;: int</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="stringliteral">            Number of negative images per individual/label required.</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="stringliteral">        &quot;neg_set_fname&quot;: string</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="stringliteral">            Filename which will be used to save the neg set.</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="stringliteral">    Notes</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="stringliteral">    -----</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="stringliteral">    If the number of images per class required is greater than the total number of images per class, </span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="stringliteral">    an error message will be printed and the program will be terminated.</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    dataset_path         = os.path.abspath(os.path.expanduser(met_params[<span class="stringliteral">&quot;dataset&quot;</span>]))</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    n_clusters           = met_params[<span class="stringliteral">&quot;n_clusters&quot;</span>]</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    n_neg_imgs_per_label = met_params[<span class="stringliteral">&quot;n_neg_imgs_per_label&quot;</span>]</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    print(<span class="stringliteral">&quot;\t* dataset_path = %s&quot;</span> % dataset_path)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    print(<span class="stringliteral">&quot;\t* n_neg_imgs_per_label = %s&quot;</span> % n_neg_imgs_per_label)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    print(<span class="stringliteral">&quot;\t* n_clusters = %d\n&quot;</span> % n_clusters)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    sample_idxs = build_label_dict(y, idxs)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    print(<span class="stringliteral">&quot;\t- Loading the dataset&quot;</span>)</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    X = np.fromfile(dataset_path, dtype=<span class="stringliteral">&quot;float32&quot;</span>)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    X = np.reshape(X, (y.size, X.size/y.size))</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    print(<span class="stringliteral">&quot;\t- Clustering selection&quot;</span>)    </div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    chosen_idxs = []</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">for</span> label, orig_label_idxs <span class="keywordflow">in</span> sample_idxs.items():</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        print(<span class="stringliteral">&quot;\t[individual: %d]&quot;</span> % label)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        X_train = X[orig_label_idxs]</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="comment"># print(&quot;\t- Normalizing the samples&quot;)</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        X_train = normalize(X_train, norm=<span class="stringliteral">&quot;l2&quot;</span>) <span class="comment"># normalize the dataset</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        kmeans  = KMeans(n_clusters=n_clusters)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="comment"># print(&quot;\t- Clustering the dataset&quot;)</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        centroid_dists = kmeans.fit_transform(X_train) <span class="comment"># cluster X_train and get the distances from each sample to each centroid</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        </div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        cluster_sample_dists = dict()</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">for</span> cluster <span class="keywordflow">in</span> np.unique(kmeans.labels_):</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            cluster_sample_dists[cluster] = []</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">for</span> sample <span class="keywordflow">in</span> xrange(kmeans.labels_.size): <span class="comment"># for each sample</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            cluster   = kmeans.labels_[sample]</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            sample_id = orig_label_idxs[sample] <span class="comment"># index with respect to y/X and not X_train</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            dist      = centroid_dists[sample][cluster] <span class="comment"># distance from the &quot;sample&quot; to its respective cluster</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            cluster_sample_dists[cluster].append((sample_id, dist))</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        </div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment"># sorts (in place) in ascending order the samples according to their distances to centroid</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">for</span> cluster <span class="keywordflow">in</span> np.unique(kmeans.labels_):</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            cluster_sample_dists[cluster].sort(key=<span class="keyword">lambda</span> tup: tup[1])</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="comment"># print(&quot;\t\t- cluster: %d - %d samples&quot; % (cluster, len(cluster_sample_dists[cluster])))</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment"># print(&quot;&quot;)</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        </div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        </div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        rep_samples = [] <span class="comment"># stores the indices with respect to y/X from the representative samples from the &lt;label&gt;</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        </div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        cluster = 0</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">while</span> len(rep_samples) &lt; n_neg_imgs_per_label:    </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            cluster = cluster % n_clusters <span class="comment"># circular cluster selection</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">if</span> len(cluster_sample_dists[cluster]) &gt;= 1:</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="comment"># print(&quot;\t- cluster = %d&quot; % cluster)</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                sample_id, dist = cluster_sample_dists[cluster].pop(0) <span class="comment"># gets and removes the key cluster from the dict</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                rep_samples.append(sample_id)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            cluster += 1</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        </div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        chosen_idxs.extend(rep_samples)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        </div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    del X</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    chosen_idxs = np.array(chosen_idxs)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">return</span> chosen_idxs</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a6709dca0cc9fd9c1047242792498d972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6709dca0cc9fd9c1047242792498d972">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def huge_to_large.main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Split the CASIA dataset into negative and positive set, according to some strategies.
The dataset used MUST BE BALANCED, i. e., it must have the same number of images per class (see the script: cut_casia.py),
in order to get more confident results.

The script can execute several negative splits, but the positive set will be the same for everyone.
</pre> <div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keyword">def </span><a class="code" href="../../d6/d81/iftTestDict1_8c.html#ac0f2228420376f4db7e1274f2b41667c">main</a>():</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Split the CASIA dataset into negative and positive set, according to some strategies.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="stringliteral">    The dataset used MUST BE BALANCED, i. e., it must have the same number of images per class (see the script: cut_casia.py),</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="stringliteral">    in order to get more confident results.</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="stringliteral">    The script can execute several negative splits, but the positive set will be the same for everyone.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (len(sys.argv) != 2):</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        print_error(<span class="stringliteral">&quot;Usage: python split_dataset.py &lt;split_params.json&gt;\n&quot;</span>, <span class="stringliteral">&quot;main&quot;</span>)</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    json_file = open(sys.argv[1])</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        params = json.load(json_file)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">except</span> (ValueError, KeyError, TypeError):</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        print_error(<span class="stringliteral">&quot;JSON format error&quot;</span>, <span class="stringliteral">&quot;main&quot;</span>)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    t1 = time.time() <span class="comment"># points the time</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    print(<span class="stringliteral">&quot;- Loading Labels&quot;</span>)</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    params[<span class="stringliteral">&quot;labels&quot;</span>] = os.path.abspath(os.path.expanduser(params[<span class="stringliteral">&quot;labels&quot;</span>]))</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    y = np.fromfile(params[<span class="stringliteral">&quot;labels&quot;</span>], dtype=<span class="stringliteral">&quot;int32&quot;</span>)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    out_dir = os.path.abspath(os.path.expanduser(params[<span class="stringliteral">&quot;out_dir&quot;</span>]))</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.exists(out_dir):</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        os.makedirs(out_dir)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    n_iters = params[<span class="stringliteral">&quot;n_iters&quot;</span>]</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">for</span> it <span class="keywordflow">in</span> xrange(1, n_iters+1):</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        print(<span class="stringliteral">&quot;- Spliting the dataset into Positive and Negative sets&quot;</span>)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        pos_train_idxs, pos_test_idxs, neg_idxs = split_dataset(y, params[<span class="stringliteral">&quot;n_pos_labels&quot;</span>], params[<span class="stringliteral">&quot;n_imgs_per_label&quot;</span>], params[<span class="stringliteral">&quot;pos_train_perc&quot;</span>])</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        </div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        print(<span class="stringliteral">&quot;- Saving Positive Train and Test sets\n&quot;</span>)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        pos_train_set_fname = os.path.join(out_dir, (<span class="stringliteral">&quot;pos_train_ids-it%02d.txt&quot;</span> % it))</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        save_idx_set(pos_train_idxs, pos_train_set_fname)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        pos_test_set_fname = os.path.join(out_dir, (<span class="stringliteral">&quot;pos_test_ids-it%02d.txt&quot;</span> % it))</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        save_idx_set(pos_test_idxs, pos_test_set_fname)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        </div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">for</span> method, met_params <span class="keywordflow">in</span> params[<span class="stringliteral">&quot;METHODS&quot;</span>].items():</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            chosen_idxs = <span class="keywordtype">None</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;RANDOM&quot;</span>:</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                print(<span class="stringliteral">&quot;- Random Negative selection&quot;</span>)</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                chosen_idxs = random_neg_set(neg_idxs, met_params)</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordflow">elif</span> method == <span class="stringliteral">&quot;RANDOM_PER_LABEL&quot;</span>:</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                print(<span class="stringliteral">&quot;- Random (Per label) Negative selection&quot;</span>)</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                chosen_idxs = random_pl_neg_set(y, neg_idxs, met_params)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">elif</span> fnmatch.fnmatch(method, <span class="stringliteral">&quot;KMEANS-*&quot;</span>):</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                print(<span class="stringliteral">&quot;- Kmeans Negative Selection&quot;</span>)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                chosen_idxs = kmeans_neg_set(y, neg_idxs, met_params)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                print(<span class="stringliteral">&quot;Invalid Sample Selection method: %s&quot;</span> % method)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keywordflow">if</span> chosen_idxs <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                neg_set_fname = met_params[<span class="stringliteral">&quot;exp_name&quot;</span>] + (<span class="stringliteral">&quot;-it%02d.txt&quot;</span> % it)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                neg_set_fname = os.path.join(out_dir, neg_set_fname) </div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                print(neg_set_fname)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                save_idx_set(chosen_idxs, neg_set_fname)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                print(<span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    print(<span class="stringliteral">&quot;\nTime elapsed %.2f secs&quot;</span> % (time.time() - t1))</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    print(<span class="stringliteral">&quot;Done...&quot;</span>)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="ttc" id="iftTestDict1_8c_html_ac0f2228420376f4db7e1274f2b41667c"><div class="ttname"><a href="../../d6/d81/iftTestDict1_8c.html#ac0f2228420376f4db7e1274f2b41667c">main</a></div><div class="ttdeci">int main(int argc, const char *argv[])</div><div class="ttdef"><b>Definition:</b> iftTestDict1.c:15</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a97e20f74b4b3db6d6d86015a4e2c7cd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97e20f74b4b3db6d6d86015a4e2c7cd3">&#9670;&nbsp;</a></span>random_neg_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def huge_to_large.random_neg_set </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>idxs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>met_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Split the Negative Set by choosing &lt;n_neg_imgs&gt; randomly.

Parameters
----------
idxs: numpy array
    Set with the indices of negative samples previously chosen.

met_params: dict
    "n_neg_imgs": int
        Number of negative images required.

    "neg_set_fname": string
        Filename which will be used to save the neg set.

Notes
-----
If the number of images required is greater than the total number of images, an error message will be printed
and the program will be terminated.
</pre> <div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keyword">def </span>random_neg_set(idxs, met_params):</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Split the Negative Set by choosing &lt;n_neg_imgs&gt; randomly.</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="stringliteral">    Parameters</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="stringliteral">    ----------</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="stringliteral">    idxs: numpy array</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="stringliteral">        Set with the indices of negative samples previously chosen.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="stringliteral">    met_params: dict</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="stringliteral">        &quot;n_neg_imgs&quot;: int</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="stringliteral">            Number of negative images required.</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="stringliteral">        &quot;neg_set_fname&quot;: string</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="stringliteral">            Filename which will be used to save the neg set.</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="stringliteral">    Notes</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="stringliteral">    -----</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="stringliteral">    If the number of images required is greater than the total number of images, an error message will be printed</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="stringliteral">    and the program will be terminated.</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    n_neg_imgs  = met_params[<span class="stringliteral">&quot;n_neg_imgs&quot;</span>]</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    chosen_idxs = <span class="keywordtype">None</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span> n_neg_imgs &lt;= idxs.size:</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        idxs_aux = np.array(idxs) </div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        np.random.shuffle(idxs_aux)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        chosen_idxs = idxs_aux[:n_neg_imgs]</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        print_error(<span class="stringliteral">&quot;Number of neg imgs required is &gt; than the neg set: %d -- %d&quot;</span> % (n_neg_imgs, idxs.size),</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="stringliteral">&quot;random_neg_set&quot;</span>)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">return</span> chosen_idxs</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a2419e8161d58dfda842659f8f146efa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2419e8161d58dfda842659f8f146efa1">&#9670;&nbsp;</a></span>random_pl_neg_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def huge_to_large.random_pl_neg_set </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>idxs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>met_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Split the Negative Set by choosing &lt;n_neg_imgs_per_label&gt; images per label/class randomly.

Parameters
----------
y: numpy array with shape (n_samples,)
    Label set.

idxs: numpy array
    Set with the indices of negative samples previously chosen.
    These indices are related with y.

met_params: dict
    "n_neg_imgs_per_label": int
        Number of negative images per class required.

    "neg_set_fname": string
        Filename which will be used to save the neg set.

Notes
-----
If the number of images per class required is greater than the total number of images per class, 
an error message will be printed and the program will be terminated.
</pre> <div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keyword">def </span>random_pl_neg_set(y, idxs, met_params):</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Split the Negative Set by choosing &lt;n_neg_imgs_per_label&gt; images per label/class randomly.</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="stringliteral">    Parameters</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="stringliteral">    ----------</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="stringliteral">    y: numpy array with shape (n_samples,)</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="stringliteral">        Label set.</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="stringliteral">    idxs: numpy array</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="stringliteral">        Set with the indices of negative samples previously chosen.</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="stringliteral">        These indices are related with y.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="stringliteral">    met_params: dict</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="stringliteral">        &quot;n_neg_imgs_per_label&quot;: int</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="stringliteral">            Number of negative images per class required.</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="stringliteral">        &quot;neg_set_fname&quot;: string</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="stringliteral">            Filename which will be used to save the neg set.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="stringliteral">    Notes</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="stringliteral">    -----</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="stringliteral">    If the number of images per class required is greater than the total number of images per class, </span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="stringliteral">    an error message will be printed and the program will be terminated.</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    n_neg_imgs_per_label = met_params[<span class="stringliteral">&quot;n_neg_imgs_per_label&quot;</span>]</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    sample_idxs = build_label_dict(y, idxs)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    chosen_idxs = []</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">for</span> cluster <span class="keywordflow">in</span> sample_idxs:</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span> n_neg_imgs_per_label &lt;= len(sample_idxs[cluster]):</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            np.random.shuffle(sample_idxs[cluster])</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            chosen_idxs.extend(sample_idxs[cluster][:n_neg_imgs_per_label])</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            print_error(<span class="stringliteral">&quot;Insufficient number of imgs from the label %d: %d imgs&quot;</span> % (cluster, len(sample_idxs[cluster])),</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="stringliteral">&quot;random_pl_neg_set&quot;</span>)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    </div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    chosen_idxs = np.array(chosen_idxs)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">return</span> chosen_idxs</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="ac06a4945b6df4807a697b7bd76c17efb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac06a4945b6df4807a697b7bd76c17efb">&#9670;&nbsp;</a></span>save_idx_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def huge_to_large.save_idx_set </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>idxs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Save the indice set to the file &lt;filename&gt;.
</pre> <div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">def </span>save_idx_set(idxs, filename):</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Save the indice set to the file &lt;filename&gt;.</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    np.savetxt(filename, idxs, fmt=<span class="stringliteral">&quot;%d&quot;</span>)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="ad84432fb8bce89b257e064005df9586b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad84432fb8bce89b257e064005df9586b">&#9670;&nbsp;</a></span>split_dataset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def huge_to_large.split_dataset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_pos_labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_imgs_per_label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pos_train_perc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Split the dataset into positive training set, positive testing set and negative set.

Parameters
----------
y: numpy array with shape (n_samples,)
    Label set.

n_pos_labels: int
    Number of positive labels required.

n_imgs_per_label: int
    Number of images per individual/label required in the positive set.

pos_train_perc: float in [0..1]
    Training Percentage from the positive training and testing set.

Returns
-------
pos_train_idxs: numpy array with shape (n_pos_labels*n_imgs_per_label*pos_train_perc)
    Set of indices from the chosen positive training samples.

pos_test_idxs: numpy array with shape (n_pos_labels*n_imgs_per_label*(1-pos_train_perc))
    Set of indices from the chosen positive testing samples.

neg_idxs: numpy array
    Set of indices from the chosen negative samples.
</pre> <div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">def </span>split_dataset(y, n_pos_labels, n_imgs_per_label, pos_train_perc):</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Split the dataset into positive training set, positive testing set and negative set.</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="stringliteral">    Parameters</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="stringliteral">    ----------</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="stringliteral">    y: numpy array with shape (n_samples,)</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="stringliteral">        Label set.</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="stringliteral">    n_pos_labels: int</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="stringliteral">        Number of positive labels required.</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral">    n_imgs_per_label: int</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">        Number of images per individual/label required in the positive set.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral">    pos_train_perc: float in [0..1]</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="stringliteral">        Training Percentage from the positive training and testing set.</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="stringliteral">    Returns</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="stringliteral">    -------</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="stringliteral">    pos_train_idxs: numpy array with shape (n_pos_labels*n_imgs_per_label*pos_train_perc)</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="stringliteral">        Set of indices from the chosen positive training samples.</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="stringliteral">    pos_test_idxs: numpy array with shape (n_pos_labels*n_imgs_per_label*(1-pos_train_perc))</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="stringliteral">        Set of indices from the chosen positive testing samples.</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="stringliteral">    neg_idxs: numpy array</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="stringliteral">        Set of indices from the chosen negative samples.</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    unique_labels = np.unique(y)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    sample_idxs   = dict()</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment"># initialize the dict</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">for</span> label <span class="keywordflow">in</span> unique_labels:</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        sample_idxs[label] = []</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment"># assign the idx to the respective labels</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">for</span> idx, label <span class="keywordflow">in</span> enumerate(y):</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        sample_idxs[label].append(idx)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment"># get the negative and positive classes</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    random.shuffle(unique_labels)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    pos_labels = unique_labels[:n_pos_labels]</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    neg_labels = unique_labels[n_pos_labels:]</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> set(neg_labels).intersection(set(pos_labels)) != set([]):</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        print_error(<span class="stringliteral">&quot;Duplicate some Negative and Positive Class&quot;</span>, <span class="stringliteral">&quot;split.split_dataset&quot;</span>)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment"># get the positive idxs</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    pos_train_idxs = []</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    pos_test_idxs  = []</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">for</span> label <span class="keywordflow">in</span> pos_labels:</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        random.shuffle(sample_idxs[label])</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        </div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">if</span> n_imgs_per_label &lt;= len(sample_idxs[label]):</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            pos_train_num = int(pos_train_perc*n_imgs_per_label)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            pos_train_idxs.extend(sample_idxs[label][:pos_train_num])</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            pos_test_idxs.extend(sample_idxs[label][pos_train_num:n_imgs_per_label])</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            print_error(<span class="stringliteral">&quot;-- WARNING - Label %d: Number of Samples &lt; Number of Imgs Per Class - %d, :%d&quot;</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                  % (label, len(sample_idxs[label]), n_imgs_per_label), <span class="stringliteral">&quot;split_dataset&quot;</span>)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment"># get the negative idxs</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    neg_idxs = []</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">for</span> label <span class="keywordflow">in</span> neg_labels:</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        random.shuffle(sample_idxs[label])</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        neg_idxs.extend(sample_idxs[label])</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    validate_pos_and_neg_sets(pos_train_idxs, pos_test_idxs, neg_idxs)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">return</span> np.array(pos_train_idxs), np.array(pos_test_idxs), np.array(neg_idxs)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="aaa9b1fe2358fea169a4983a9396deb15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa9b1fe2358fea169a4983a9396deb15">&#9670;&nbsp;</a></span>validate_pos_and_neg_sets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def huge_to_large.validate_pos_and_neg_sets </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pos_train_idxs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pos_test_idxs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>neg_idxs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check if there are common samples (overlapping) among the pos train set, pos test set, and neg set.</pre> <div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">def </span>validate_pos_and_neg_sets(pos_train_idxs, pos_test_idxs, neg_idxs):</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Check if there are common samples (overlapping) among the pos train set, pos test set, and neg set.&quot;&quot;&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> len(set(neg_idxs)) != len(neg_idxs):</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        print_error(<span class="stringliteral">&quot;Not Unique Negative Idxs&quot;</span>, <span class="stringliteral">&quot;validate_pos_and_neg_sets&quot;</span>)</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> len(set(pos_train_idxs)) != len(pos_train_idxs):</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        print_error(<span class="stringliteral">&quot;Not Unique Pos. Train. Idxs&quot;</span>, <span class="stringliteral">&quot;validate_pos_and_neg_sets&quot;</span>)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">if</span> len(set(pos_test_idxs)) != len(pos_test_idxs):</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        print_error(<span class="stringliteral">&quot;Not Unique Pos. Test. Idxs&quot;</span>, <span class="stringliteral">&quot;validate_pos_and_neg_sets&quot;</span>)</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">if</span> set(neg_idxs).intersection(set(pos_train_idxs)) != set([]):</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        print_error(<span class="stringliteral">&quot;Common idx(s) between Neg. Set and Pos. Train. Set&quot;</span>, <span class="stringliteral">&quot;validate_pos_and_neg_sets&quot;</span>)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> set(neg_idxs).intersection(set(pos_test_idxs)) != set([]):</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        print_error(<span class="stringliteral">&quot;Common idx(s) between Neg. Set and Pos. Test. Set&quot;</span>, <span class="stringliteral">&quot;validate_pos_and_neg_sets&quot;</span>)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> set(pos_train_idxs).intersection(set(pos_test_idxs)) != set([]):</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        print_error(<span class="stringliteral">&quot;Common idx(s) between Pos. Train. Set and Pos. Test. Set&quot;</span>, <span class="stringliteral">&quot;validate_pos_and_neg_sets&quot;</span>)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Aug 18 2018 16:22:35 for libIFT by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
